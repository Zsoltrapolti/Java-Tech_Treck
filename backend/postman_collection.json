{
  "info": {
    "_postman_id": "d9b3c6da-5bd4-4d01-9f10-collection",
    "name": "Krumpi Backend API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Collection for testing APIs in Spring Boot on port 8081 (Basic Auth admin/password). Create payloads use Postman dynamic variables for random data."
  },
  "variable": [
    { "key": "base_url", "value": "http://localhost:8081" },
    { "key": "basic_auth_user", "value": "admin" },
    { "key": "basic_auth_password", "value": "password" },
    { "key": "productId", "value": "1" },
    { "key": "employeeId", "value": "1" },
    { "key": "orderId", "value": "1" }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login (no auth required)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"{{basic_auth_user}}\",\n  \"password\": \"{{basic_auth_password}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            },
            "auth": { "type": "noauth" }
          }
        }
      ]
    },
    {
      "name": "Products",
      "auth": {
        "type": "basic",
        "basic": [
          { "key": "username", "value": "{{basic_auth_user}}", "type": "string" },
          { "key": "password", "value": "{{basic_auth_password}}", "type": "string" }
        ]
      },
      "item": [
        {
          "name": "List products",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/products",
              "host": ["{{base_url}}"],
              "path": ["api", "products"]
            }
          }
        },
        {
          "name": "Get product by id",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/products/{{productId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "products", "{{productId}}"]
            }
          }
        },
        {
          "name": "Create product",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Product {{$randomInt}}\",\n  \"type\": \"RAW_MATERIAL\",\n  \"unitOfMeasure\": \"kg\",\n  \"quantity\": {{$randomInt}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/products",
              "host": ["{{base_url}}"],
              "path": ["api", "products"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "  const json = pm.response.json();",
                  "  if (json.id) pm.collectionVariables.set('productId', json.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update product",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Product {{$randomInt}}\",\n  \"type\": \"RAW_MATERIAL\",\n  \"unitOfMeasure\": \"kg\",\n  \"quantity\": {{$randomInt}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/products/{{productId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "products", "{{productId}}"]
            }
          }
        },
        {
          "name": "Delete product",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{base_url}}/api/products/{{productId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "products", "{{productId}}"]
            }
          }
        },
        {
          "name": "Health test",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/products/test",
              "host": ["{{base_url}}"],
              "path": ["api", "products", "test"]
            }
          }
        }
      ]
    },
    {
      "name": "Employees",
      "auth": {
        "type": "basic",
        "basic": [
          { "key": "username", "value": "{{basic_auth_user}}", "type": "string" },
          { "key": "password", "value": "{{basic_auth_password}}", "type": "string" }
        ]
      },
      "item": [
        {
          "name": "List employees",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/employees",
              "host": ["{{base_url}}"],
              "path": ["api", "employees"]
            }
          }
        },
        {
          "name": "Get employee by id",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/employees/{{employeeId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "employees", "{{employeeId}}"]
            }
          }
        },
        {
          "name": "Create employee",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"{{$randomFirstName}}\",\n  \"lastName\": \"{{$randomLastName}}\",\n  \"role\": \"{{$randomJobTitle}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/employees",
              "host": ["{{base_url}}"],
              "path": ["api", "employees"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "  const json = pm.response.json();",
                  "  if (json.id) pm.collectionVariables.set('employeeId', json.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update employee",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"{{$randomFirstName}}\",\n  \"lastName\": \"{{$randomLastName}}\",\n  \"role\": \"{{$randomJobTitle}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/employees/{{employeeId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "employees", "{{employeeId}}"]
            }
          }
        },
        {
          "name": "Delete employee",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{base_url}}/api/employees/{{employeeId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "employees", "{{employeeId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Orders",
      "auth": {
        "type": "basic",
        "basic": [
          { "key": "username", "value": "{{basic_auth_user}}", "type": "string" },
          { "key": "password", "value": "{{basic_auth_password}}", "type": "string" }
        ]
      },
      "item": [
        {
          "name": "List orders",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": ["{{base_url}}"],
              "path": ["api", "orders"]
            }
          }
        },
        {
          "name": "Get order by id",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/orders/{{orderId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "orders", "{{orderId}}"]
            }
          }
        },
        {
          "name": "Create order",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"{{$randomCompanyName}}\",\n  \"status\": \"NEW\",\n  \"responsibleEmployee\": { \"id\": {{employeeId}} }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": ["{{base_url}}"],
              "path": ["api", "orders"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "  const json = pm.response.json();",
                  "  if (json.id) pm.collectionVariables.set('orderId', json.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update order",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"{{$randomCompanyName}}\",\n  \"status\": \"IN_PROGRESS\",\n  \"responsibleEmployee\": { \"id\": {{employeeId}} }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/orders/{{orderId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "orders", "{{orderId}}"]
            }
          }
        },
        {
          "name": "Delete order",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{base_url}}/api/orders/{{orderId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "orders", "{{orderId}}"]
            }
          }
        }
      ]
    }
  ]
}
